{"version":3,"sources":["workers/orderBook.worker.ts","components/OrderBook/OrderBookTable/OrderBookTable.tsx","views/OrderBook/OrderBookJSS.tsx","constants/colors.ts","components/OrderBook/OrderBookRow/OrderBookRowJSS.tsx","components/OrderBook/OrderBookRow/OrderBookRow.tsx","utils/formatters.ts","utils/styles.ts","constants/screens.ts","components/OrderBook/OrderBookTable/OrderBookTableJSS.tsx","constants/orderBookWebSocket.const.ts","components/OrderBook/OrderBookDisplay/OrderBookDisplayJSS.tsx","components/OrderBook/OrderBookSpread/OrderBookSpreadJSS.tsx","components/OrderBook/OrderBookSpread/OrderBookSpread.tsx","components/OrderBook/OrderBookDisplay/OrderBookDisplay.tsx","components/OrderBook/OrderBookHeader/OrderBookHeaderJSS.tsx","components/OrderBook/OrderBookHeader/OrderBookHeader.tsx","components/OrderBook/OrderBookButtons/OrderBookButtonsJSS.tsx","components/OrderBook/OrderBookButtons/OrderBookButtons.tsx","hooks/useOrderBookWorker.ts","utils/throttle.ts","hooks/useIsMobile.ts","views/OrderBook/OrderBook.tsx","App.tsx","index.js"],"names":["addMethods","methods","module","exports","w","Worker","name","Column","useStyles","createUseStyles","container","display","flexDirection","maxWidth","margin","column","justifyContent","marginRight","COLORS","black","dark","negative1","negative2","positive1","positive2","violet","tableRow","width","isAsksTable","isMobile","color","background","row","alignItems","textAlign","padding","cell","OrderBookRow","order","maxTotal","columns","styles","backgroundWidth","total","toFixed","getCellStyle","price","formatValue","value","toString","replace","num","commaEveryThirdChar","className","style","map","SMALL_SCREEN_MEDIA_QUERY","table","borderCollapse","heading","border","borderLeft","borderRight","body","ProductId","EventType","size","OrderBookTable","props","orders","columnsToRender","reverse","ordersToRender","hideHeader","toUpperCase","spreadContainer","OrderBookSpread","orderBook","highestBid","bids","lowestAsk","asks","spread","Number","spreadPercentage","displayedSpread","OrderBookDisplay","classes","ordersNumber","getOrdersWithTotal","previousTotal","slice","Math","round","asksWithTotal","bidsWithTotal","length","asksMaxTotal","bidsMaxTotal","max","header","OrderBookHeader","marginTop","button","height","borderRadius","violetButton","composes","backgroundColor","greenButton","disconnectContainer","disconnectText","OrderBookButtons","disconnectedOnBlur","reconnect","toggleFeed","onClick","WorkerMessages","pi_ethusd","useOrderBookWorker","useState","setOrderBook","worker","useRef","onMessageHandler","event","data","type","useEffect","current","orderBookWorker","onmessage","throttle","func","limit","inThrottle","lastResult","args","arguments","context","this","setTimeout","apply","useIsMobile","delay","getIsMobile","window","innerWidth","setIsMobile","debouncedHandleResize","addEventListener","removeEventListener","OrderBook","setDisconnectedOnBlur","subscribedProduct","setSubscribedProduct","onLostFocus","postMessage","productId","toSubscribe","pi_xbtusd","App","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.d9009452.chunk.js","sourcesContent":["\n\t\t\t\tvar addMethods = require(\"../../node_modules/workerize-loader/dist/rpc-wrapper.js\")\n\t\t\t\tvar methods = [\"socket\"]\n\t\t\t\tmodule.exports = function() {\n\t\t\t\t\tvar w = new Worker(__webpack_public_path__ + \"daba64fefa711758fe41.worker.js\", { name: \"[hash].worker.js\" })\n\t\t\t\t\taddMethods(w, methods)\n\t\t\t\t\t\n\t\t\t\t\treturn w\n\t\t\t\t}\n\t\t\t","import { OrderWithTotal } from \"src/types/orderBook.type\";\r\nimport OrderBookRow from \"../OrderBookRow/OrderBookRow\";\r\nimport useStyles from \"./OrderBookTableJSS\";\r\n\r\nexport enum Column {\r\n  price = \"price\",\r\n  size = \"size\",\r\n  total = \"total\",\r\n}\r\n\r\ninterface Props {\r\n  orders: OrderWithTotal[];\r\n  maxTotal: number;\r\n  isAsksTable?: boolean;\r\n  isMobile: boolean;\r\n}\r\n\r\nexport const columns = [Column.price, Column.size, Column.total];\r\n\r\nconst OrderBookTable = (props: Props): React.ReactElement => {\r\n  const styles = useStyles();\r\n  const { orders, maxTotal, isAsksTable, isMobile } = props;\r\n  const reverseColumns = !isAsksTable && !isMobile;\r\n  const columnsToRender = reverseColumns ? [...columns].reverse() : columns;\r\n\r\n  const ordersToRender =\r\n    isMobile && !isAsksTable ? [...orders].reverse() : orders;\r\n  const hideHeader = isMobile && !isAsksTable;\r\n\r\n  return (\r\n    <table className={styles.table}>\r\n      {!hideHeader && (\r\n        <thead>\r\n          <tr className={styles.heading}>\r\n            {columnsToRender.map((column) => (\r\n              <th key={column} className={styles.cell}>\r\n                {column.toUpperCase()}\r\n              </th>\r\n            ))}\r\n          </tr>\r\n        </thead>\r\n      )}\r\n      <tbody className={styles.body}>\r\n        {ordersToRender.map((order) => (\r\n          <OrderBookRow\r\n            key={order.price}\r\n            columns={columnsToRender}\r\n            order={order}\r\n            maxTotal={maxTotal}\r\n            isAsksTable={isAsksTable}\r\n            isMobile={isMobile}\r\n          />\r\n        ))}\r\n      </tbody>\r\n    </table>\r\n  );\r\n};\r\n\r\nexport default OrderBookTable;\r\n","import { createUseStyles } from \"react-jss\";\r\n\r\nconst useStyles = createUseStyles({\r\n  container: {\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n    maxWidth: \"1280px\",\r\n    margin: \"auto\",\r\n  },\r\n  column: {\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n    justifyContent: \"center\",\r\n    marginRight: \"30%\",\r\n  },\r\n});\r\n\r\nexport default useStyles;\r\n","const COLORS = {\r\n  black: \"#141622\",\r\n  dark: \"#222431\",\r\n  negative1: \"#a23838\",\r\n  negative2: \"#3a1f28\",\r\n  positive1: \"#31805c\",\r\n  positive2: \"#193434\",\r\n  violet: \"#5934d4\",\r\n};\r\n\r\nexport default COLORS;\r\n","import { createUseStyles } from \"react-jss\";\r\nimport COLORS from \"src/constants/colors\";\r\n\r\nexport const tableRow = (\r\n  width: string,\r\n  isAsksTable: boolean,\r\n  isMobile: boolean\r\n): { background: string } => {\r\n  const direction = isAsksTable || isMobile ? \"to right\" : \"to left\";\r\n  const color = isAsksTable ? COLORS.negative2 : COLORS.positive2;\r\n  return {\r\n    background: `linear-gradient(${direction}, ${color} ${width}%, ${COLORS.black} ${width}%)`,\r\n  };\r\n};\r\n\r\nconst useStyles = createUseStyles({\r\n  row: {\r\n    color: \"white\",\r\n    display: \"flex\",\r\n    flexDirection: \"row\",\r\n    justifyContent: \"space-between\",\r\n    width: \"100%\",\r\n    alignItems: \"flex-start\",\r\n    textAlign: \"right\",\r\n    padding: \"4px 0\",\r\n  },\r\n  cell: {\r\n    textAlign: \"center\",\r\n    width: \"100%\",\r\n  },\r\n});\r\n\r\nexport default useStyles;\r\n","import COLORS from \"src/constants/colors\";\r\nimport { OrderWithTotal } from \"src/types/orderBook.type\";\r\nimport {\r\n  commaEveryThirdChar,\r\n  formatNumberWithCommas,\r\n} from \"src/utils/formatters\";\r\nimport useStyles, { tableRow } from \"./OrderBookRowJSS\";\r\nimport { Column } from \"../OrderBookTable/OrderBookTable\";\r\n\r\ninterface Props {\r\n  order: OrderWithTotal;\r\n  isAsksTable?: boolean;\r\n  maxTotal: number;\r\n  columns: Column[];\r\n  isMobile: boolean;\r\n}\r\n\r\nconst OrderBookRow = ({\r\n  order,\r\n  isAsksTable,\r\n  maxTotal,\r\n  columns,\r\n  isMobile,\r\n}: Props): React.ReactElement => {\r\n  const styles = useStyles();\r\n  const backgroundWidth = ((order.total * 100) / maxTotal).toFixed(1);\r\n  const getCellStyle = (column: Column): { color?: string } => {\r\n    if (column !== Column.price) {\r\n      return {};\r\n    }\r\n    return { color: isAsksTable ? COLORS.negative1 : COLORS.positive1 };\r\n  };\r\n\r\n  const formatValue = (value: number, column: Column): string =>\r\n    column === Column.price\r\n      ? formatNumberWithCommas(value)\r\n      : commaEveryThirdChar(value);\r\n\r\n  return (\r\n    <tr\r\n      className={styles.row}\r\n      style={tableRow(backgroundWidth, isAsksTable, isMobile)}\r\n      key={order.price}\r\n    >\r\n      {columns.map((column) => (\r\n        <td key={column} className={styles.cell} style={getCellStyle(column)}>\r\n          {formatValue(order[column], column)}\r\n        </td>\r\n      ))}\r\n    </tr>\r\n  );\r\n};\r\n\r\nexport default OrderBookRow;\r\n","export const formatNumberWithCommas = (num: number): string =>\r\n  num\r\n    .toFixed(2)\r\n    .toString()\r\n    .replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\r\n\r\nexport const commaEveryThirdChar = (num: number): string =>\r\n  num.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\r\n","import { SMALL_SCREEN_WIDTH } from \"src/constants/screens\";\r\n\r\nexport const SMALL_SCREEN_MEDIA_QUERY = `@media (max-width: ${SMALL_SCREEN_WIDTH}px)`;\r\n","export const SMALL_SCREEN_WIDTH = 720;\r\n","import { createUseStyles } from \"react-jss\";\r\nimport COLORS from \"src/constants/colors\";\r\nimport { SMALL_SCREEN_MEDIA_QUERY } from \"src/utils/styles\";\r\n\r\nconst useStyles = createUseStyles({\r\n  table: {\r\n    borderCollapse: \"collapse\",\r\n    width: \"100%\",\r\n    maxWidth: \"900px\",\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n  },\r\n  heading: {\r\n    display: \"flex\",\r\n    color: \"grey\",\r\n    width: \"100%\",\r\n    justifyContent: \"space-between\",\r\n    border: `1px solid ${COLORS.dark}`,\r\n    borderLeft: \"none\",\r\n    borderRight: \"none\",\r\n    padding: \"2px 0\",\r\n  },\r\n  body: {\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n  },\r\n  cell: {\r\n    textAlign: \"center\",\r\n    width: \"100%\",\r\n  },\r\n  [SMALL_SCREEN_MEDIA_QUERY]: {\r\n    body: {\r\n      flexDirection: \"column-reverse\",\r\n    },\r\n  },\r\n});\r\n\r\nexport default useStyles;\r\n","export enum ProductId {\r\n  pi_ethusd = \"PI_ETHUSD\",\r\n  pi_xbtusd = \"PI_XBTUSD\",\r\n}\r\n\r\nexport enum EventType {\r\n  subscribe = \"subscribe\",\r\n  unsubscribe = \"unsubscribe\",\r\n}\r\n\r\nexport const FeedTypes = {\r\n  book_ui_1: \"book_ui_1\",\r\n  book_ui_1_snapshot: \"book_ui_1_snapshot\",\r\n};\r\n\r\nexport const WorkerMessages = {\r\n  update_orderbook: \"update_orderbook\",\r\n  toggle_feed: \"toggle_feed\",\r\n  close_subscription: \"close_subscription\",\r\n  subscribe: \"subscribe\",\r\n};\r\n\r\nexport const DEFAULT_PRODUCT_ID = ProductId.pi_ethusd;\r\nexport const WS_ENDPOINT = \"wss://www.cryptofacilities.com/ws/v1\";\r\n","import { createUseStyles } from \"react-jss\";\r\nimport { SMALL_SCREEN_MEDIA_QUERY } from \"src/utils/styles\";\r\n\r\nconst useStyles = createUseStyles({\r\n  container: {\r\n    display: \"flex\",\r\n    flexDirection: \"row\",\r\n    margin: \"auto\",\r\n    width: \"100%\",\r\n  },\r\n  [SMALL_SCREEN_MEDIA_QUERY]: {\r\n    container: {\r\n      flexDirection: \"column-reverse\",\r\n    },\r\n  },\r\n});\r\n\r\nexport default useStyles;\r\n","import { createUseStyles } from \"react-jss\";\r\n\r\nconst useStyles = createUseStyles({\r\n  spreadContainer: {\r\n    width: \"100%\",\r\n    textAlign: \"center\",\r\n    color: \"grey\",\r\n    margin: \"0.4rem\",\r\n  },\r\n});\r\n\r\nexport default useStyles;\r\n","import { OrderBook } from \"src/types/orderBook.type\";\r\nimport useStyles from \"./OrderBookSpreadJSS\";\r\n\r\ninterface Props {\r\n  orderBook: OrderBook;\r\n}\r\n\r\nconst OrderBookSpread = ({ orderBook }: Props): React.ReactElement => {\r\n  const styles = useStyles();\r\n  const highestBid = orderBook.bids?.[0]?.price;\r\n  const lowestAsk = orderBook.asks?.[0]?.price;\r\n  if (!highestBid || !lowestAsk) {\r\n    return null;\r\n  }\r\n  const spread = (Number(lowestAsk) - Number(highestBid)).toFixed(1);\r\n  const spreadPercentage = (\r\n    (1 - Number(highestBid) / Number(lowestAsk)) *\r\n    100\r\n  ).toFixed(2);\r\n  const displayedSpread = `Spread ${spread} (${spreadPercentage}%)`;\r\n\r\n  return (\r\n    <div className={styles.spreadContainer}>\r\n      <span>{displayedSpread}</span>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OrderBookSpread;\r\n","import OrderBookTable from \"../OrderBookTable/OrderBookTable\";\r\nimport useStyles from \"./OrderBookDisplayJSS\";\r\nimport {\r\n  OrderBook,\r\n  Order,\r\n  OrderWithTotal,\r\n} from \"../../../types/orderBook.type\";\r\nimport OrderBookSpread from \"../OrderBookSpread/OrderBookSpread\";\r\n\r\ninterface Props {\r\n  orderBook: OrderBook;\r\n  isMobile: boolean;\r\n}\r\n\r\nconst OrderBookDisplay = ({\r\n  orderBook,\r\n  isMobile,\r\n}: Props): React.ReactElement => {\r\n  const classes = useStyles();\r\n  const ordersNumber = isMobile ? 12 : 20;\r\n\r\n  const getOrdersWithTotal = (orders: Order[] = []): OrderWithTotal[] => {\r\n    let previousTotal = 0;\r\n    return orders.slice(0, ordersNumber).map((order) => {\r\n      const total = Math.round(previousTotal + order.size);\r\n      previousTotal = total;\r\n      return {\r\n        ...order,\r\n        total,\r\n      };\r\n    });\r\n  };\r\n\r\n  const asksWithTotal = getOrdersWithTotal(orderBook.asks);\r\n  const bidsWithTotal = getOrdersWithTotal(orderBook.bids);\r\n\r\n  if (asksWithTotal.length < 1 && bidsWithTotal.length < 1) {\r\n    return null;\r\n  }\r\n\r\n  const asksMaxTotal = asksWithTotal[ordersNumber - 1].total;\r\n  const bidsMaxTotal = bidsWithTotal[ordersNumber - 1].total;\r\n  const maxTotal = Math.max(asksMaxTotal, bidsMaxTotal);\r\n\r\n  return (\r\n    <div className={classes.container}>\r\n      <OrderBookTable\r\n        orders={bidsWithTotal}\r\n        maxTotal={maxTotal}\r\n        isMobile={isMobile}\r\n      />\r\n      {isMobile && <OrderBookSpread orderBook={orderBook} />}\r\n      <OrderBookTable\r\n        orders={asksWithTotal}\r\n        maxTotal={maxTotal}\r\n        isMobile={isMobile}\r\n        isAsksTable\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OrderBookDisplay;\r\n","import { createUseStyles } from \"react-jss\";\r\n\r\nconst useStyles = createUseStyles({\r\n  container: {\r\n    display: \"flex\",\r\n    justifyContent: \"space-between\",\r\n    margin: \".5rem 0\",\r\n  },\r\n  header: {\r\n    color: \"white\",\r\n    textAlign: \"left\",\r\n    width: \"100%\",\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n  },\r\n});\r\n\r\nexport default useStyles;\r\n","import { OrderBook } from \"src/types/orderBook.type\";\r\nimport useStyles from \"./OrderBookHeaderJSS\";\r\nimport OrderBookSpread from \"../OrderBookSpread/OrderBookSpread\";\r\n\r\ninterface Props {\r\n  orderBook: OrderBook;\r\n  isMobile: boolean;\r\n}\r\n\r\nconst OrderBookHeader = ({\r\n  orderBook,\r\n  isMobile,\r\n}: Props): React.ReactElement => {\r\n  const styles = useStyles();\r\n  return (\r\n    <div className={styles.container}>\r\n      <div className={styles.header}>Order Book</div>\r\n      {!isMobile && <OrderBookSpread orderBook={orderBook} />}\r\n      <div className={styles.header} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OrderBookHeader;\r\n","import { createUseStyles } from \"react-jss\";\r\nimport COLORS from \"src/constants/colors\";\r\n\r\nconst useStyles = createUseStyles({\r\n  container: {\r\n    display: \"flex\",\r\n    width: \"100%\",\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    marginTop: \"1rem\",\r\n  },\r\n  button: {\r\n    width: \"8rem\",\r\n    height: \"2rem\",\r\n    color: \"white\",\r\n    borderRadius: \"4px\",\r\n    border: \"none\",\r\n  },\r\n  violetButton: {\r\n    composes: \"$button\",\r\n    backgroundColor: COLORS.violet,\r\n  },\r\n  greenButton: {\r\n    composes: \"$button\",\r\n    backgroundColor: COLORS.positive1,\r\n  },\r\n  disconnectContainer: {\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n  },\r\n  disconnectText: {\r\n    color: \"white\",\r\n  },\r\n});\r\n\r\nexport default useStyles;\r\n","import useStyles from \"./OrderBookButtonsJSS\";\r\n\r\ninterface Props {\r\n  disconnectedOnBlur: boolean;\r\n  reconnect: () => void;\r\n  toggleFeed: () => void;\r\n}\r\n\r\nconst OrderBookButtons = ({\r\n  disconnectedOnBlur,\r\n  reconnect,\r\n  toggleFeed,\r\n}: Props): React.ReactElement => {\r\n  const classes = useStyles();\r\n  return (\r\n    <div className={classes.container}>\r\n      {disconnectedOnBlur && (\r\n        <div className={classes.disconnectContainer}>\r\n          <button className={classes.greenButton} onClick={reconnect}>\r\n            Reconnect\r\n          </button>\r\n          <div className={classes.disconnectText}>\r\n            The feed has been disconnected due to inactivity.\r\n          </div>\r\n        </div>\r\n      )}\r\n      {!disconnectedOnBlur && (\r\n        <button className={classes.violetButton} onClick={toggleFeed}>\r\n          Toggle feed\r\n        </button>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OrderBookButtons;\r\n","import { useState, useRef, useEffect } from \"react\";\r\nimport { WorkerMessages } from \"src/constants/orderBookWebSocket.const\";\r\nimport { OrderBook } from \"src/types/orderBook.type\";\r\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\r\n// @ts-ignore\r\nimport orderBookWorker from \"workerize-loader!../workers/orderBook.worker\";\r\n\r\nexport interface OrderBookHook {\r\n  orderBook: OrderBook;\r\n  worker: Worker;\r\n}\r\n\r\nexport const useOrderBookWorker = (): OrderBookHook => {\r\n  const [orderBook, setOrderBook] = useState(<OrderBook>{});\r\n  const worker = useRef<Worker>();\r\n\r\n  const onMessageHandler = (event: MessageEvent): void => {\r\n    switch (event.data.type) {\r\n      case WorkerMessages.update_orderbook: {\r\n        setOrderBook(event.data.orderBook);\r\n        break;\r\n      }\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    worker.current = orderBookWorker();\r\n    worker.current.onmessage = onMessageHandler;\r\n  }, []);\r\n\r\n  return { orderBook, worker: worker.current };\r\n};\r\n\r\nexport default useOrderBookWorker;\r\n","/* eslint-disable @typescript-eslint/no-explicit-any */\r\ntype ThrottledFunction<T extends (...args: any) => any> = (\r\n  ...args: Parameters<T>\r\n) => ReturnType<T>;\r\n\r\nexport function throttle<T extends (...args: any) => any>(\r\n  func: T,\r\n  limit: number\r\n): ThrottledFunction<T> {\r\n  let inThrottle: boolean;\r\n  let lastResult: ReturnType<T>;\r\n\r\n  return function (this: any): ReturnType<T> {\r\n    // eslint-disable-next-line prefer-rest-params\r\n    const args = arguments;\r\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\r\n    const context = this;\r\n\r\n    if (!inThrottle) {\r\n      inThrottle = true;\r\n\r\n      setTimeout(() => (inThrottle = false), limit);\r\n\r\n      lastResult = func.apply(context, args);\r\n    }\r\n\r\n    return lastResult;\r\n  };\r\n}\r\n","import { useEffect, useState } from \"react\";\r\nimport { SMALL_SCREEN_WIDTH } from \"src/constants/screens\";\r\nimport { throttle } from \"src/utils/throttle\";\r\n\r\nfunction useIsMobile(delay = 100): boolean {\r\n  const getIsMobile = (): boolean => window.innerWidth < SMALL_SCREEN_WIDTH;\r\n  const [isMobile, setIsMobile] = useState(getIsMobile());\r\n\r\n  useEffect(() => {\r\n    const handleResize = (): void => {\r\n      setIsMobile(getIsMobile());\r\n    };\r\n    const debouncedHandleResize = throttle(handleResize, delay);\r\n    window.addEventListener(\"resize\", debouncedHandleResize);\r\n    return () => {\r\n      window.removeEventListener(\"resize\", debouncedHandleResize);\r\n    };\r\n  }, [delay]);\r\n\r\n  return isMobile;\r\n}\r\n\r\nexport default useIsMobile;\r\n","import { useEffect, useState } from \"react\";\r\nimport useStyles from \"./OrderBookJSS\";\r\nimport OrderBookDisplay from \"src/components/OrderBook/OrderBookDisplay/OrderBookDisplay\";\r\nimport OrderBookHeader from \"src/components/OrderBook/OrderBookHeader/OrderBookHeader\";\r\nimport OrderBookButtons from \"src/components/OrderBook/OrderBookButtons/OrderBookButtons\";\r\nimport useOrderBookWorker from \"src/hooks/useOrderBookWorker\";\r\nimport {\r\n  ProductId,\r\n  WorkerMessages,\r\n} from \"../../constants/orderBookWebSocket.const\";\r\nimport useIsMobile from \"src/hooks/useIsMobile\";\r\n\r\nconst OrderBook = (): React.ReactElement => {\r\n  const classes = useStyles();\r\n  const isMobile = useIsMobile();\r\n  const [disconnectedOnBlur, setDisconnectedOnBlur] = useState(false);\r\n  const [subscribedProduct, setSubscribedProduct] = useState(\r\n    ProductId.pi_ethusd\r\n  );\r\n  const { worker, orderBook } = useOrderBookWorker();\r\n\r\n  const reconnect = (): void => {\r\n    setDisconnectedOnBlur(false);\r\n    worker.postMessage({\r\n      type: WorkerMessages.subscribe,\r\n      productId: subscribedProduct,\r\n    });\r\n  };\r\n\r\n  const toggleFeed = (): void => {\r\n    const toSubscribe =\r\n      subscribedProduct === ProductId.pi_ethusd\r\n        ? ProductId.pi_xbtusd\r\n        : ProductId.pi_ethusd;\r\n\r\n    worker.postMessage({\r\n      type: WorkerMessages.toggle_feed,\r\n      productId: toSubscribe,\r\n    });\r\n\r\n    setSubscribedProduct(toSubscribe);\r\n  };\r\n\r\n  const onLostFocus = (): void => {\r\n    if (!disconnectedOnBlur) {\r\n      worker.postMessage({\r\n        type: WorkerMessages.close_subscription,\r\n      });\r\n      setDisconnectedOnBlur(true);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    window.addEventListener(\"visibilitychange\", onLostFocus);\r\n    return () => {\r\n      window.removeEventListener(\"visibilitychange\", onLostFocus);\r\n    };\r\n  });\r\n\r\n  return (\r\n    <div className={classes.container}>\r\n      <OrderBookHeader orderBook={orderBook} isMobile={isMobile} />\r\n\r\n      <OrderBookDisplay orderBook={orderBook} isMobile={isMobile} />\r\n\r\n      <OrderBookButtons\r\n        disconnectedOnBlur={disconnectedOnBlur}\r\n        reconnect={reconnect}\r\n        toggleFeed={toggleFeed}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default OrderBook;\r\n","import \"./App.css\";\nimport React from \"react\";\nimport OrderBook from \"./views/OrderBook/OrderBook\";\n\nconst App = (): React.ReactElement => {\n  return <OrderBook />;\n};\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App.tsx\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}